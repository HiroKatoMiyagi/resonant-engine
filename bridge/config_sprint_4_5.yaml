# Sprint 4.5: Claude Code API Integration 設定ファイル

# PostgreSQL接続設定
database:
  host: ${POSTGRES_HOST:localhost}
  port: ${POSTGRES_PORT:5432}
  database: ${POSTGRES_DB:resonant_dashboard}
  user: ${POSTGRES_USER:resonant}
  password: ${POSTGRES_PASSWORD}

# Claude API設定
claude:
  api_key: ${ANTHROPIC_API_KEY}
  model: "claude-sonnet-4-20250514"
  max_tokens: 4096
  temperature: 0.7

# Claude Code Client設定
claude_code:
  # ワークスペースモード: 'repository' または 'isolated'
  workspace_mode: repository

  # Repositoryパス
  repository_path: /home/user/resonant-engine

  # Isolated modeのワークスペース
  isolated_workspace_path: /tmp/resonant_workspace

  # 実行制御
  execution:
    max_concurrent_sessions: 3
    default_timeout_seconds: 300
    max_timeout_seconds: 900

  # セキュリティ設定
  security:
    auto_create_branch: true
    branch_prefix: "claude/session-"

    # 書き込み許可パス
    allowed_write_paths:
      - bridge/
      - backend/
      - frontend/
      - docs/02_components/
      - docker/

    # 読み取り専用パス
    readonly_paths:
      - CLAUDE.md
      - docs/01_core_architecture/
      - .git/

    auto_backup: true
    backup_dir: /var/backups/resonant_engine

# コンテキストローディング設定
context_loading:
  enabled: true

  # 常に含めるファイル
  essential_files:
    - CLAUDE.md
    - README.md
    - docs/01_core_architecture/resonant_regulations.md

  # Sprint検出時の動作
  auto_load_dependencies: true  # Sprint 4.5 → Sprint 1-4も読む

  # 最大コンテキストファイル数
  max_context_files: 20

# DB記憶統合設定
db_memory:
  enabled: true
  max_memories_per_query: 5
  similarity_threshold: 0.3

# 通知設定
notifications:
  enabled: true
  auto_cleanup_days: 7

# ログ設定
logging:
  level: INFO
  format: "%(asctime)s [%(levelname)s] %(message)s"
  file: /var/log/resonant_engine/intent_bridge.log
  max_bytes: 10485760  # 10MB
  backup_count: 3

# モニタリング設定
monitoring:
  prometheus:
    enabled: false
    port: 9090

  metrics:
    - intent_processing_total
    - intent_processing_duration_seconds
    - intent_processing_errors_total
    - claude_code_sessions_total
    - claude_code_execution_duration_seconds
