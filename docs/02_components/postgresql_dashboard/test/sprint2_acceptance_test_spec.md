# Sprint 2: FastAPI バックエンドAPI 受け入れテスト仕様書

**対象**: Sprint 2 FastAPI実装
**テスト項目数**: 25件
**承認者**: 宏啓（プロジェクトオーナー）

---

## 1. 機能テスト（15件）

### API基盤テスト

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| F01 | FastAPI起動 | `uvicorn app.main:app` | サーバー起動成功 | |
| F02 | ヘルスチェック | `GET /health` | `{"status": "healthy"}` | |
| F03 | Swagger UI | `GET /docs` | OpenAPI UIが表示 | |
| F04 | DB接続 | `/health` で接続確認 | `"database": "connected"` | |

### Messages API テスト

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| F05 | メッセージ作成 | `POST /api/messages` | 201 + UUID返却 | |
| F06 | メッセージ一覧 | `GET /api/messages` | 200 + items配列 | |
| F07 | メッセージ詳細 | `GET /api/messages/{id}` | 200 + 詳細データ | |
| F08 | メッセージ更新 | `PUT /api/messages/{id}` | 200 + 更新後データ | |
| F09 | メッセージ削除 | `DELETE /api/messages/{id}` | 204 No Content | |

### Specifications API テスト

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| F10 | 仕様書CRUD | 全CRUD操作 | 全て正常動作 | |
| F11 | タグフィルタ | `GET ?tags=sprint1` | タグでフィルタ成功 | |

### Intents API テスト

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| F12 | IntentCRUD | 全CRUD操作 | 全て正常動作 | |
| F13 | ステータス更新 | `PATCH /{id}/status` | ステータス変更成功 | |

### Notifications API テスト

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| F14 | 通知CRUD | 全CRUD操作 | 全て正常動作 | |
| F15 | 既読マーク | `POST /mark-read` | 既読更新成功 | |

---

## 2. 性能テスト（5件）

| ID | テスト名 | 測定 | 閾値 | 結果 |
|----|---------|------|------|------|
| P01 | API応答時間 | `GET /api/messages` | < 100ms | ___ms |
| P02 | 同時接続 | 10並列リクエスト | 全て成功 | |
| P03 | 大量データ取得 | 1000件 limit=100 | < 200ms | ___ms |
| P04 | DB接続プール | 20同時クエリ | プール機能 | |
| P05 | レスポンスサイズ | 圧縮有効確認 | gzip対応 | |

---

## 3. バリデーションテスト（3件）

| ID | テスト名 | 入力 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| V01 | 必須項目欠落 | `{"content": ""}` | 422 Validation Error | |
| V02 | 型不一致 | `{"priority": "high"}` | 422 Type Error | |
| V03 | 範囲外値 | `{"priority": 101}` | 422 Range Error | |

---

## 4. セキュリティテスト（2件）

| ID | テスト名 | 手順 | 期待結果 | 結果 |
|----|---------|------|----------|------|
| S01 | CORS設定 | 他ドメインからリクエスト | 適切なヘッダー返却 | |
| S02 | SQLインジェクション | `'; DROP TABLE--` | 攻撃が無効化 | |

---

## 5. テスト結果サマリー

**合計**: ___/25 PASS

**重要テスト（必須PASS）**:
- F01: FastAPI起動
- F04: DB接続
- F05-F09: Messages CRUD
- P01: API応答時間

**判定**: PASS / FAIL

**承認**: ____________________

**日付**: ____________________

---

**作成日**: 2025-11-17
**作成者**: Kana（外界翻訳層 / Claude Sonnet 4.5）
